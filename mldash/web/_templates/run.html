{% autoescape None %}

<div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2">
    <nav aria-label="breadcrumb">
        <ol class="breadcrumb">
            <li class="breadcrumb-item"><a href="#desc/{{ desc.desc_name }}" onClick="loadPage(this)">{{ desc.desc_name }}</a></li>
            <li class="breadcrumb-item"><a href="#desc/{{ desc.desc_name }}/expr/{{ expr.expr_name }}" onClick=loadPage(this)>{{ expr.expr_name }}</a></li>
            <li class="breadcrumb-item active" aria-current="page">{{ run.run_name }}</li>
      </ol>
    </nav>
</div>

<div class="experiment">
    <dl class="row">
        <dt>Run Description <a href="javascript:;" onClick="updateText(this)" id="edit-desc-link" data-desc="{{ desc.desc_name }}" data-expr="{{ expr.expr_name }}" data-run="{{ run.run_name }}" data-key="run_description" data-preid="edit-desc">Edit</a></dt>
        <dd><pre class="pre-url" id="edit-desc">{{ run.run_description }}</pre></dd>
        <dt>Run Notes <a href="javascript:;" onClick="updateText(this)" id="edit-note-link" data-desc="{{ desc.desc_name }}" data-expr="{{ expr.expr_name }}" data-run="{{ run.run_name }}" data-key="run_notes" data-preid="edit-note">Edit</a></dt>
        <dd><pre class="pre-url" id="edit-note">{{ run.run_notes }}</pre></dd>
        <dt>Create Time</dt>
        <dd>{{ run.create_time }}</dd>
        <dt>Update Time</dt>
        <dd>{{ run.update_time }}</dd>

        {% if run.refer is not None %}
        <dt>Parent</dt>
        <dd>
        <a href="#desc/{{ desc.desc_name }}/expr/{{ expr.expr_name }}/run/{{ run.run_name }}" onClick="loadPage(this)" class="run-link" data-desc="{{ desc.desc_name }}" data-expr="{{ expr.expr_name }}" data-run="{{ run.refer.run_name }}">{{ run.refer.run_name }}</a>
        </dd>
        {% end %}

        <dt>Metrics</dt>
        <dd>{{ format_kv(run.metrics) }}</dd>
        <dt>Command</dt>
        <dd><code>{{ run.command }}</code></dd>
        <dt>Args</dt>
        <dd>{{ format_kv(run.args) }}</dd>
        <dt>Configs</dt>
        <dd>{{ format_kv(run.configs) }}</dd>
        <dt>Metainfo File</dt>
        <dd>{{ format_log_fpath(run.metainfo_file) }}</dd>
        <dt>Log File</dt>
        <dd>{{ format_log_fpath(run.log_file) }}</dd>
        <dt>Meter File</dt>
        <dd>{{ format_log_fpath(run.meter_file) }}</dd>
        <dt>TensorBoard Dir</dt>
        <dd><pre>{{ run.tb_dir }}</pre></dd>
        <dt>Extra Information</dt>
        <dd><pre>{{ run.extra_info }}</pre></dd>
    </dl>

    {% if len(run.referee) > 0 %}
    <div class="table-responsive">
        <table class="table table-striped table-bordered table-sm">
            <thead>
                <tr><th>Sub-Runs</th></tr>
            </thead>
            <tbody>
                {% for rrun in run.referee %}
                <tr>
                    <td>
                        <div><b>SubRun:</b>
                            <a href="#desc/{{ desc.desc_name }}/expr/{{ expr.expr_name }}/run/{{ rrun.run_name }}" onClick="loadPage(this)" class="run-link">{{ rrun.run_name }}</a>
                            (<b>Created:</b> {{ rrun.create_time }}; <b>Updated</b>: {{ rrun.update_time }})
                        </div>
                        <div><b>Metrics:</b> {{ format_kv_inline(rrun.metrics) }}</div>
                        <div><b>Command:</b> <code>{{ rrun.command }}</code></div>
                        <div><b>Highlight args:</b> {{ format_kv_inline(rrun.highlight_args) }}</div>
                        <div><b>Highlight configs:</b> {{ format_kv_inline(rrun.highlight_configs) }}</div>
                        {% if rrun.refer is not None %}
                        <div><b>Parent:</b> <span><a href="#desc/{{ desc.desc_name }}/expr/{{ expr.expr_name }}/run/{{ rrun.refer.run_name }}" onClick="loadPage(this)" class="run-link" >{{ rrun.refer.run_name }}</a></span></div>
                        {% end %}
                        <div><b>Description:</b> <span class="inline-pre pre-url">{{ rrun.run_description }}</span></div>
                    </td>
                </tr>
                {% end %}
            </tbody>
        </table>
    </div>
    {% end %}
</div>

